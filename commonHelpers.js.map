{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImg({q=\"\",key = '44778676-049b64250b69e7d3e774d3724', image_type = 'photo',orientation = 'horizontal',safesearch = true, page= 1, per_page= 15}) {\n    try {\n        const response = await axios.get(\n            BASE_URL, {\n            params: {\n                q,\n                key,\n                image_type,\n                orientation,\n                safesearch,\n                page,\n                per_page\n            }\n        })\n        return response.data;\n    }\n    catch (error) {\n        if (error.response) {\n            throw new Error(`Error: ${error.response.status} - ${error.response.data}`);\n        } else {\n            throw new Error(error.message);\n        }\n    }\n    \n};","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { list } from '../main';\n\n\nlet modal = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionType: 'attr',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\n\nexport function createMarkup(arr) {\n  if (arr.length === 0) {\n     return showMessage();\n  }\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n      }) => {\n        return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=${largeImageURL} onclick=\"event.preventDefault()\">\n    <img\n      class=\"gallery-image\"\n      src=${webformatURL}\n      alt=${tags} /></a>\n      <div class=\"list-info\">\n      <ul class=\"info-items\">\n  <li class=\"item-info\">\n    <h3  class=\"item-title\">Likes</h3>\n    <p class=\"item-text\">${likes}</p>\n  </li>\n  <li class=\"item-info\">\n    <h3 class=\"item-title\">Views</h3>\n    <p class=\"item-text\">${views}</p>\n  </li>\n  <li class=\"item-info\">\n    <h3 class=\"item-title\">Comments</h3>\n    <p class=\"item-text\">${comments}</p>\n  </li>\n  <li class=\"item-info\">\n    <h3 class=\"item-title\">Downloads</h3>\n    <p class=\"item-text\">${downloads}</p>\n  </li>\n</ul>\n      </div>\n</li>`;\n      }\n    )\n    .join('');\n  list.insertAdjacentHTML('beforeend', markup);\n  modal.refresh();\n}\n\nfunction showMessage() {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      messageColor: '#fff',\n      backgroundColor: 'red',\n      position: 'topRight',\n    });\n}\n\n","import { getImg } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport const searchForm = document.querySelector('.js-form');\n\nconst loader = document.querySelector('.js-loader');\nconst loadMoreBtn = document.querySelector('.js-loadmore');\nconst hiddenClass = 'is-hidden';\nexport const list = document.querySelector('.gallery');\n\n\n\nsearchForm.addEventListener('submit', handlerSubmit);\nloadMoreBtn.addEventListener('click', handleLoad);\n\nbtnHidden(loadMoreBtn);\n\nconst searchParams = {\n  q: '',\n    page: 1,\n    per_page: 15,\n    max_Page : 0,\n};\n\nfunction emptyInput() {\n  return iziToast.show({\n    message: 'Please enter your request.',\n    messageColor: '#fff',\n    backgroundColor: 'red',\n    position: 'topRight',\n  });\n}\n\nfunction onFetchError() {\n  iziToast.show({\n    message: 'Something went wrong, please try again',\n    messageColor: '#fff',\n    backgroundColor: 'red',\n    position: 'topRight',\n  });\n}\n\nfunction endCollection() {\n  iziToast.show({\n    message: \"We're sorry, but you've reached the end of search results.\",\n    messageColor: '#fff',\n    backgroundColor: 'red',\n    position: 'topRight',\n  });\n}\n\nasync function handlerSubmit(event) {\n    event.preventDefault();\n  btnHidden(loadMoreBtn);\n  searchParams.page = 1;\n  list.innerHTML = '';\n  const form = event.currentTarget;\n  searchParams.q = form.elements.search.value.toLowerCase().trim();\n  loader.classList.add('loader');\n\n    try {\n      if (!searchParams.q) {\n        form.reset();\n        emptyInput();\n        return;\n      }\n    const { hits, total } = await getImg(searchParams);\n    searchParams.max_Page = Math.ceil(total / searchParams.per_page);\n    createMarkup(hits);\n    if (hits.length > 0 && searchParams.page < searchParams.max_Page) {\n      btnShow(loadMoreBtn);\n    } else {\n      btnHidden(loadMoreBtn);\n    }\n  } catch (error) {\n    console.error(error);\n  } finally {\n    form.reset();\n    loader.classList.remove('loader');\n  }\n};\n\nfunction btnHidden(button) {\n  button.classList.add(hiddenClass);\n}\n\nfunction btnShow(button) {\n  button.classList.remove(hiddenClass);\n}\n\nfunction btnDisabled(button) {\n  button.disabled = true;\n}\n\nfunction btnEnabled(button) {\n  button.disabled = false;\n}\n\nasync function handleLoad() {\n  searchParams.page += 1;\n  btnDisabled(loadMoreBtn);\n  loader.classList.add('loader');\n  try {\n    const { hits } = await getImg(searchParams);\n      createMarkup(hits);\n      const item = document.querySelector('.gallery-item');\n      const heightOfElem = item.getBoundingClientRect().height;\n      console.log(typeof(heightOfElem * 2));\n      window.scrollBy({\n        top: heightOfElem * 2,\n        behavior: 'smooth',\n      });\n  } catch {\n    onFetchError();\n  } finally {\n    btnEnabled(loadMoreBtn);\n      loader.classList.remove('loader');\n      if (searchParams.page === searchParams.max_Page) {\n          endCollection();\n         loadMoreBtn.removeEventListener('click', handleLoad); \n      }\n  }\n};\n"],"names":["BASE_URL","getImg","q","key","image_type","orientation","safesearch","page","per_page","axios","error","modal","SimpleLightbox","createMarkup","arr","showMessage","markup","webformatURL","tags","likes","views","comments","downloads","largeImageURL","list","iziToast","searchForm","loader","loadMoreBtn","hiddenClass","handlerSubmit","handleLoad","btnHidden","searchParams","emptyInput","onFetchError","endCollection","event","form","hits","total","btnShow","button","btnDisabled","btnEnabled","heightOfElem"],"mappings":"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"}